in â† âŸ¨"R 4", "U 4", "L 3", "D 1","R 4","D 1","L 5","R 2"âŸ©
#in â† âŸ¨"R 5", "U 8", "L 8", "D 3", "R 17", "D 10", "L 25", "U 20"âŸ©

ParseInt â† {F â† 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0' â‹„ ('-'=âŠ‘ğ•©)â—¶Fâ€¿(-âˆ˜Fâˆ˜(1âŠ¸â†“)) ğ•©}
in â†© { (âŠ‘ğ•©) â‹ˆ ParseInt 2â†“ğ•© }Â¨ in

ApplyMotion â† {
 directionâ€¿countğ•Šstate:
 v â† {'R': 1â€¿0; 'L': Â¯1â€¿0; 'U': 0â€¿1; 'D': 0â€¿Â¯1} direction

 AdjustNext â† {
  dxâ€¿dy â† ğ•¨ - txâ€¿ty â† ğ•©
  (1<|dx) âˆ¨ 1<|dy ? âŸ¨tx + Ã—dx, ty + Ã—dyâŸ©; ğ•©
 }

 {
  ğ•Šropeâ€¿visitedPositions:
  newRope â† AdjustNext` +âŸœvâŒ¾âŠ‘ rope
  newRopeâ€¿(visitedPositions âˆ¾ Â¯1â†‘newRope)
 }âŸcount state
}

ApplyMotions â† { ğ•© ApplyMotionÂ´ âŒ½ğ•¨ }

â€¢Show â‰ â· 1âŠ‘ in ApplyMotions âŸ¨2 â¥Š <0â€¿0,âŸ¨âŸ©âŸ©
â‰ â· 1âŠ‘ in ApplyMotions âŸ¨10 â¥Š <0â€¿0,âŸ¨âŸ©âŸ©
